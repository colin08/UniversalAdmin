@model Universal.Entity.WorkJob
@{
    ViewBag.Title = "查看任务";
    ViewData["tabLeft"] = "workjob";
    ViewData["tabTop"] = "manager";
}

<!--头部脚本-->
@section head
{
    <link href="~/Assets/theme/css/dev.css" rel="stylesheet" />
}
<!--头部脚本 end-->

<div class="wapper">
    @Html.Partial("_MenuLeft", this.ViewData)

    <div class="rightBox">
        <div class="container">
            <div class="tit1">
                <div class="inner">
                    <a href="/WorkJob/Index" class="fl f16"><i class="i-back"></i>任务指派</a>
                    <b class="tit1Txt fr">查看任务</b>
                </div>
            </div>

            <div class="userInfo sysIn">
                <ul>
                    <li>
                        <div class="lilt">任务标题</div>
                        <div class="limd">
                            <span>@Model.Title</span>
                        </div>
                        <div class="litip"></div>
                    </li>
                    <li>
                        <div class="lilt">状态</div>
                        <div class="limd">
                            <span>@Model.StatusText</span>
                        </div>
                        <div class="litip"></div>
                    </li>
                    <li>
                        <div class="lilt">任务内容</div>
                        <div class="limd">
                            <span>@Html.Raw(Model.Content)</span>
                        </div>
                        <div class="litip"></div>
                    </li>
                    <li>
                        <div class="lilt">计划完成时间</div>
                        <div class="limd">
                            <span>@Model.DoneTime.ToString("yyyy-MM-dd")</span>
                        </div>
                        <div class="litip"></div>
                    </li>
                    <li>
                        <div class="lilt">执行人</div>
                        <div class="limd">
                            <ul>
                                @foreach (var item in Model.WorkJobUsers.ToList())
                                {
                                    <li><span>@item.CusUser.NickName</span>&nbsp;<span style="color:@(item.IsConfirm ? "green":"red")">@(item.IsConfirm ? "已完成":"未完成")</span>
                                        &nbsp;&nbsp;&nbsp;
                                        @if(item.IsConfirm)
                                        {
                                            var str_json = Newtonsoft.Json.JsonConvert.SerializeObject(item.ConfrimFiles.ToList());
                                            var contnet = item.ConfirmText;

                                            <a href="javascript:;" onclick="finishFunc(@str_json,'@contnet')">完成情况</a>
                                        }
                                    </li>

                                }
                            </ul>
                        </div>
                        <div class="litip"></div>
                    </li>
                    <li>
                        <div class="lilt">附件</div>
                        <div class="limd">
                            <ul>
                                @foreach (var item in Model.FileList)
                                {
                                    <li><span>@item.FileName &nbsp; @item.FileSize</span>&nbsp;&nbsp;&nbsp;<a href="/Tools/Down?path=@item.FilePath&name=@item.FileName" target="_blank">下载</a></li>
                                }
                            </ul>
                        </div>
                        <div class="litip"></div>
                    </li>
                    <li>
                        <div class="lilt">发布者</div>
                        <div class="limd">
                            <span>@Model.CusUser.NickName</span>
                        </div>
                        <div class="litip"></div>
                    </li>
                    <li>
                        <div class="lilt">发布时间</div>
                        <div class="limd">
                            <span>@Model.AddTime</span>
                        </div>
                        <div class="litip"></div>
                    </li>
                    <li>
                        <div class="lilt">&nbsp;</div>
                        <div class="limd">
                            <button type="button" onclick="location.href = '/WorkJob/Index';" class="btn1 grey">返回</button>
                        </div>
                    </li>
                </ul>
            </div>
        </div>
        <div class="footer">Copyright ©  深圳市诚泰城市更新咨询服务有限公司  粤ICP备13089427号-1</div>
    </div>

</div>

<!--底部脚本-->
@section foot
{
    <script type="text/javascript">
	    function finishFunc(dataJson,content){
			var html='<div class="down_dialog">';
			    html+='<ul>';
				for(var i=0; i<dataJson.length; i++){
					html+='<li>';
					html+='<a href="'+dataJson[i].FilePath+'" target="_blank">';
					html+='<i></i>';
					html+='<span>'+dataJson[i].FileName+'</span>';
					html+='<label>'+dataJson[i].FileSize+'</label>';
					html+='<span>&nbsp;&nbsp;&nbsp;&nbsp;下载</span>';
					html+='</a>';
					html+='</li>';
				}
			    html+='</ul>';
				html+='<p>'+content+'</p>';
			    html+='</div>';
			if(!content||content==''){
			   content="暂无内容显示"
			}	
		       showDialog({title:'完成详情',html:html,fix:true});
		}
        $(function(){
		})
    </script>

}
<!--底部脚本 end-->
