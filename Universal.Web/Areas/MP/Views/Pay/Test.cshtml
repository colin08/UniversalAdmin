
@{
    Layout = null;
}

<!DOCTYPE html>

<html>
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
    <link href="~/Assets/mui/css/mui.min.css" rel="stylesheet" />
    <script src="~/Assets/js/jquery.min.js"></script>
    <title>支付测试</title>
    <style type="text/css">
        .content { display: flex; justify-content: center; flex-wrap: nowrap; flex-direction: column; align-content: center; align-items: center; margin-top: 60%; }
        h5 { margin-top: 15px; }
    </style>

   <script type="text/javascript">
       function pay() {
           WeixinJSBridge.invoke('getBrandWCPayRequest', {
               "appId": "@ViewData["appId"]", //公众号名称，由商户传入
               "timeStamp": "@ViewData["timeStamp"]", //时间戳
               "nonceStr": "@ViewData["nonceStr"]", //随机串
               "package": "@Html.Raw(ViewData["package"])",//扩展包
               "signType": "MD5", //微信签名方式:MD5
               "paySign": "@ViewData["paySign"]" //微信签名
       }, function (res) {

           if (res.err_msg == "get_brand_wcpay_request:ok") {
               $(".mui-btn").attr("disabled", "true")
               $(".mui-btn").text("支付成功，即将跳转...");
               setTimeout(window.location.href = '/mp/pay/testok', 2);
           }
       });
       }
   </script>

</head>
<body>
    <div class="mui-content">
        <div class="content">
            <h5>支付￥ @ViewData["price"] 进行测试</h5>
            <button type="button" onclick="pay()" class="mui-btn" style="margin-top: 20px;">点击支付</button>
        </div>
    </div>
</body>
</html>
